# PostgreSQL configuration file
# Documentation: https://www.postgresql.org/docs/current/runtime-config.html

# - Connection Settings -
listen_addresses = '{{ item.postgresql_listen_address | default(instance_defaults.postgresql_listen_address) }}'
port = {{ item.postgresql_port | default(instance_defaults.postgresql_port) }}
max_connections = {{ item.postgresql_max_connections | default(instance_defaults.postgresql_max_connections) }}

# - Security and Authentication -
ssl = '{{ item.postgresql_ssl  | default(instance_defaults.postgresql_ssl)  }}'
ssl_ca_file = '{{ item.postgresql_ssl_ca_file  | default(instance_defaults.postgresql_ssl_ca_file)  }}'
ssl_cert_file = '{{ item.postgresql_ssl_cert_file  | default(instance_defaults.postgresql_ssl_cert_file)  }}'
ssl_key_file = '{{ item.postgresql_ssl_key_file  | default(instance_defaults.postgresql_ssl_key_file)  }}'
password_encryption = '{{ item.postgresql_password_encryption | default(instance_defaults.postgresql_password_encryption) }}'

# - Memory Settings -
shared_buffers = '{{ item.postgresql_shared_buffers | default(instance_defaults.postgresql_shared_buffers) }}'
work_mem = '{{ item.postgresql_work_mem | default(instance_defaults.postgresql_work_mem) }}'
maintenance_work_mem = '{{ item.postgresql_maintenance_work_mem | default(instance_defaults.postgresql_maintenance_work_mem) }}'
effective_cache_size = '{{ item.postgresql_effective_cache_size | default(instance_defaults.postgresql_effective_cache_size) }}'
maintenance_work_mem = '{{ item.postgresql_maintenance_work_mem | default(instance_defaults.postgresql_work_mem) }}'
checkpoint_completion_target = '{{ item.postgresql_checkpoint_completion_target | default(instance_defaults.postgresql_checkpoint_completion_target) }}'
wal_buffers = '{{ item.postgresql_wal_buffers | default(instance_defaults.postgresql_wal_buffers) }}'
huge_pages = '{{ item.postgresql_huge_pages | default(instance_defaults.postgresql_huge_pages) }}'

# - Kernel Resource Usage -
max_files_per_process = {{ item.postgresql_max_files_per_process | default(instance_defaults.postgresql_max_files_per_process) }}
shared_preload_libraries = '{{ item.postgresql_shared_preload_libraries | default(instance_defaults.postgresql_shared_preload_libraries) }}'

# - Cost-based Vacuum Delay -
autovacuum = '{{ item.postgresql_autovacuum | default(instance_defaults.postgresql_autovacuum) }}'
autovacuum_naptime = '{{ item.postgresql_autovacuum_naptime | default(instance_defaults.postgresql_autovacuum_naptime) }}'
autovacuum_vacuum_threshold = {{ item.postgresql_autovacuum_vacuum_threshold | default(instance_defaults.postgresql_autovacuum_vacuum_threshold) }}
autovacuum_analyze_threshold = {{ item.postgresql_autovacuum_analyze_threshold | default(instance_defaults.postgresql_autovacuum_analyze_threshold) }}
autovacuum_work_mem = '{{ item.postgresql_autovacuum_work_mem | default(instance_defaults.postgresql_autovacuum_work_mem) }}'

# - Write Ahead Log -
wal_level = '{{ item.postgresql_wal_level | default(instance_defaults.postgresql_wal_level) }}'
archive_mode = '{{ item.postgresql_archive_mode | default(instance_defaults.postgresql_archive_mode) }}'
archive_command = '{{ item.postgresql_archive_command | default(instance_defaults.postgresql_archive_command) }}'
max_wal_size = '{{ item.postgresql_max_wal_size | default(instance_defaults.postgresql_max_wal_size) }}'
min_wal_size = '{{ item.postgresql_min_wal_size | default(instance_defaults.postgresql_min_wal_size) }}'

# - Replication -
max_wal_senders = '{{ item.postgresql_max_wal_senders | default(instance_defaults.postgresql_max_wal_senders) }}'
wal_keep_size = '{{ item.postgresql_wal_keep_size | default(instance_defaults.postgresql_wal_keep_size) }}'
hot_standby = '{{ item.postgresql_hot_standby | default(instance_defaults.postgresql_hot_standby) }}'

# - Query Tuning -
default_statistics_target = {{ item.postgresql_default_statistics_target | default(instance_defaults.postgresql_default_statistics_target) }}
random_page_cost = {{ item.postgresql_random_page_cost | default(instance_defaults.postgresql_random_page_cost) }}
effective_io_concurrency = {{ item.postgresql_effective_io_concurrency | default(instance_defaults.postgresql_effective_io_concurrency) }}
max_worker_processes = {{ item.postgresql_max_worker_processes | default(instance_defaults.postgresql_max_worker_processes) }}
max_parallel_workers_per_gather = {{ item.postgresql_max_parallel_workers_per_gather | default(instance_defaults.postgresql_max_parallel_workers_per_gather) }}
max_parallel_workers = {{ item.postgresql_max_parallel_workers | default(instance_defaults.postgresql_max_parallel_workers) }}
max_parallel_maintenance_workers = {{ item.postgresql_max_parallel_maintenance_workers | default(instance_defaults.postgresql_max_parallel_maintenance_workers) }}

# - Logging -
logging_collector = '{{ item.postgresql_logging_collector | default(instance_defaults.postgresql_logging_collector) }}'
log_directory = '{{ item.postgresql_log_directory | default(instance_defaults.postgresql_log_directory) }}'
log_filename = '{{ item.postgresql_log_filename | default(instance_defaults.postgresql_log_filename) }}'
log_rotation_age = '{{ item.postgresql_log_rotation_age | default(instance_defaults.postgresql_log_rotation_age) }}'
log_rotation_size = '{{ item.postgresql_log_rotation_size | default(instance_defaults.postgresql_log_rotation_size) }}'
log_min_duration_statement = {{ item.postgresql_log_min_duration_statement | default(instance_defaults.postgresql_log_min_duration_statement) }}
log_line_prefix = '{{ item.postgresql_log_line_prefix | default(instance_defaults.postgresql_log_line_prefix) }}'
log_timezone = '{{ item.postgresql_log_timezone | default(instance_defaults.postgresql_log_timezone) }}'
log_destination = '{{ item.postgresql_log_destination | default(instance_defaults.postgresql_log_destination) }}'

# - Locale and Formatting -
datestyle = '{{ item.postgresql_datestyle | default(instance_defaults.postgresql_datestyle) }}'
timezone = '{{ item.postgresql_timezone | default(instance_defaults.postgresql_timezone) }}'
lc_messages = '{{ item.postgresql_lc_messages | default(instance_defaults.postgresql_lc_messages) }}'
lc_monetary = '{{ item.postgresql_lc_monetary | default(instance_defaults.postgresql_lc_monetary) }}'
lc_numeric = '{{ item.postgresql_lc_numeric | default(instance_defaults.postgresql_lc_numeric) }}'
lc_time = '{{ item.postgresql_lc_time | default(instance_defaults.postgresql_lc_time) }}'

# - Miscellaneous -
default_text_search_config = '{{ item.postgresql_default_text_search_config | default(instance_defaults.postgresql_default_text_search_config) }}'

# Add any custom settings below this line

{{ item.postgresql_custom_settings | default(instance_defaults.postgresql_custom_settings) }}

